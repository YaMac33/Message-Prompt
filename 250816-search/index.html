<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>静的サイトで導入するサイト内検索：Lunr.js（自力）とAlgolia（外部）の2パターン解説 🔎</title>
  <meta name="description" content="静的サイトにサイト内検索を導入する2つの方法、自力で実装するLunr.jsと高機能な外部サービスAlgoliaについて、それぞれのメリットと実装手順を解説します。">

  <script async src="https://www.googletagmanager.com/gtag/js?id=G-MQ9ZB4LYWP"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-MQ9ZB4LYWP');
  </script>

  <style>
    /* Reset & Globals */
    :root {
      --header-bg: #fff;
      --body-bg: #f4f7f6;
      --article-bg: #ffffff;
      --text-color: #333;
      --heading-color: #2c3e50;
      --accent-color-1: #008080; /* Teal */
      --accent-color-2: #00aaff; /* Light Blue */
      --grey-color: #666666;
      --border-color: #e0e0e0;
      --code-bg: #2d2d2d;
      --code-color: #f8f8f2;
      --header-height: 70px;
    }
    *, *::before, *::after {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }
    body {
      font-family: 'Helvetica Neue', Arial, 'Hiragino Kaku Gothic ProN', 'Hiragino Sans', Meiryo, sans-serif;
      line-height: 1.7;
      background-color: var(--body-bg);
      color: var(--text-color);
      padding-top: var(--header-height);
    }
    a {
      color: var(--accent-color-1);
      text-decoration: none;
      transition: color 0.3s;
    }
    a:hover {
      color: var(--accent-color-2);
      text-decoration: underline;
    }
    img {
      max-width: 100%;
      height: auto;
    }

    /* Header */
    .site-header {
      background-color: var(--header-bg);
      padding: 0 20px;
      position: fixed;
      top: 0;
      width: 100%;
      z-index: 1000;
      box-shadow: 0 2px 5px rgba(0,0,0,0.05);
      height: var(--header-height);
      display: flex;
      align-items: center;
    }
    .header-container {
      width: 100%;
      max-width: 1200px;
      margin: 0 auto;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    .logo {
      font-size: 28px;
      font-weight: bold;
      letter-spacing: 1.5px;
      transition: color 0.3s;
      text-decoration: none;
    }
    .logo:hover {
      text-decoration: none;
      color: var(--accent-color-2);
    }
    .logo-teal { color: var(--accent-color-1); }
    .logo-grey { color: var(--grey-color); }
    .main-nav ul {
      margin: 0;
      padding: 0;
      list-style: none;
      display: flex;
    }
    .main-nav li { margin-left: 30px; }
    .main-nav a {
      font-size: 16px;
      padding: 5px;
      position: relative;
      transition: color 0.3s;
      text-decoration: none;
    }
    .main-nav a:hover {
      color: var(--accent-color-2);
      text-decoration: none;
    }
    .main-nav a::after {
      content: '';
      position: absolute;
      width: 100%;
      height: 2px;
      background-color: var(--accent-color-2);
      bottom: -5px;
      left: 0;
      transform: scaleX(0);
      transform-origin: center;
      transition: transform 0.3s ease;
    }
    .main-nav a:hover::after { transform: scaleX(1); }

    /* Main Article Styles - Unique Design */
    .main-content {
      padding: 40px 20px;
    }
    .article-container {
      max-width: 900px;
      margin: 0 auto;
      background-color: var(--article-bg);
      padding: 40px 50px;
      border-radius: 8px;
      box-shadow: 0 4px 15px rgba(0,0,0,0.08);
    }
    .article-header h1 {
      font-size: 2.5em;
      color: var(--heading-color);
      margin-bottom: 20px;
      line-height: 1.3;
      letter-spacing: -1px;
    }
    article h2, article h3, article h4 {
      color: var(--heading-color);
      margin: 2em 0 0.8em;
      line-height: 1.4;
      scroll-margin-top: calc(var(--header-height) + 20px);
    }
    article h2 {
      font-size: 1.8em;
      border-bottom: 2px solid var(--accent-color-1);
      padding-bottom: 0.4em;
    }
    article h3 {
      font-size: 1.5em;
      border-left: 5px solid var(--accent-color-1);
      padding-left: 0.8em;
    }
    article h4 {
      font-size: 1.2em;
      color: var(--grey-color);
      font-weight: bold;
    }
    article p {
      margin-bottom: 1.2em;
    }
    article ul {
      margin-bottom: 1.2em;
      padding-left: 25px;
    }
    article li {
      margin-bottom: 0.5em;
    }
    article strong {
      color: var(--accent-color-1);
    }
    
    /* Code Block Styles */
    .code-block-wrapper {
      position: relative;
      margin: 1.5em 0;
    }
    article pre {
      background-color: var(--code-bg);
      color: var(--code-color);
      padding: 20px;
      border-radius: 6px;
      overflow-x: auto;
      font-family: 'Menlo', 'Consolas', 'Monaco', monospace;
      font-size: 0.9em;
      line-height: 1.5;
    }
    article code {
        font-family: 'Menlo', 'Consolas', 'Monaco', monospace;
        background-color: #eef1f2;
        padding: 0.2em 0.4em;
        border-radius: 3px;
        font-size: 0.85em;
    }
    article pre code {
      background-color: transparent;
      padding: 0;
      border-radius: 0;
      font-size: 1em;
    }
    .copy-btn {
      position: absolute;
      top: 10px;
      right: 10px;
      background-color: #555;
      color: #fff;
      border: none;
      padding: 5px 10px;
      border-radius: 4px;
      cursor: pointer;
      font-size: 12px;
      transition: background-color 0.2s;
    }
    .copy-btn:hover {
      background-color: var(--accent-color-2);
    }
    .copy-btn:active {
      background-color: var(--accent-color-1);
    }

    /* Footer */
    .site-footer {
      text-align: center;
      padding: 30px 20px;
      margin-top: 40px;
      background-color: var(--header-bg);
      color: var(--grey-color);
      font-size: 0.9em;
      border-top: 1px solid var(--border-color);
    }
    .footer-container {
      max-width: 1200px;
      margin: 0 auto;
    }
    
    /* Responsive */
    @media (max-width: 768px) {
      .article-container {
        padding: 25px;
      }
      .article-header h1 {
        font-size: 2em;
      }
      article h2 {
        font-size: 1.6em;
      }
      article h3 {
        font-size: 1.3em;
      }
      .header-container {
        flex-direction: column;
        padding: 10px 0;
      }
      .site-header {
        height: auto;
      }
      body {
        padding-top: 60px; /* Adjust for potentially smaller header */
      }
    }
  </style>
</head>
<body>

  <header class="site-header">
    <div class="header-container">
      <a href="/SideNote/" class="logo">
        <span class="logo-teal">Side</span><span class="logo-grey">Note</span>
      </a>
      <nav class="main-nav">
        <ul>
          </ul>
      </nav>
    </div>
  </header>

  <main class="main-content">
    <article class="article-container">
      <header class="article-header">
        <h1 id="top-title">25.8.16 静的サイトで導入するサイト内検索：Lunr.js（自力）とAlgolia（外部）の2パターン解説 🔎 | SideNote</h1>
      </header>
      
      <p>外部サービスに頼らず、無料でサイト内検索を実装する方法です。サイトの全ページの情報をまとめたJSONファイルを手動（またはスクリプトで）作成し、それを使って検索します。</p>

      <h2 id="method-a">方法A：Lunr.js を使う（自力で完結させる方法） 🧰</h2>

      <h3 id="step1">ステップ1：検索データ search-index.json を作成する</h3>
      <p>まず、サイト内の検索対象にしたいページの情報をまとめたJSONファイルを作成します。作業は手動でもスクリプトでも構いませんが、このファイルが検索の核になります。</p>

      <h4 id="json-example">search-index.json のイメージ（例）</h4>
      <div class="code-block-wrapper">
        <pre><code class="language-json">[
  {
    "id": 0,
    "url": "/about.html",
    "title": "このサイトについて",
    "content": "このサイトの運営方針や目的について説明しています。..."
  },
  {
    "id": 1,
    "url": "/products/item01.html",
    "title": "製品Aの紹介",
    "content": "主力製品である製品Aの機能や特徴を詳しく解説します。..."
  }
]</code></pre>
        <button class="copy-btn" title="Copy to clipboard">Copy</button>
      </div>
      <p><strong>ポイント：</strong> <code>id</code>は0から開始する連番、<code>url</code>はページパス、<code>title</code>と<code>content</code>は検索にヒットさせたい情報を要約して入れます。</p>

      <h3 id="step2">ステップ2：HTMLに検索フォームと結果エリアを設置する</h3>
      <h4 id="form-example">検索フォームの最低限の例：</h4>
      <div class="code-block-wrapper">
        <pre><code class="language-html">&lt;label for="search-input"&gt;サイト内を検索（2文字以上）🔎&lt;/label&gt;
&lt;input type="search" id="search-input" placeholder="キーワードを入力..."&gt;
&lt;ul id="results-container"&gt;&lt;/ul&gt;
</code></pre>
        <button class="copy-btn" title="Copy to clipboard">Copy</button>
      </div>

      <h3 id="step3">ステップ3：JavaScriptを記述する（Lunr.jsを使用）</h3>
      <p>以下のスクリプトを追加します。まずは Lunr.js 本体を読み込む必要があります（例：CDN）。</p>
      <h4 id="js-example">以下は記事中のサンプルコードです（抜粋）。実際は <code>&lt;script src="..."&gt;&lt;/script&gt;</code> をページに含めてください。</h4>
      <div class="code-block-wrapper">
        <pre><code class="language-html">&lt;script src="https://unpkg.com/lunr/lunr.min.js"&gt;&lt;/script&gt;
&lt;script&gt;
(async function() {
  const searchInput = document.getElementById('search-input');
  const resultsContainer = document.getElementById('results-container');
  
  // 1. 検索用JSONをフェッチ
  const response = await fetch('/search-index.json');
  const documents = await response.json();
  
  // 2. Lunr.jsのインデックスを作成
  const idx = lunr(function () {
    this.ref('id');
    this.field('title');
    this.field('content');
    
    documents.forEach(function (doc) {
      this.add(doc);
    }, this);
  });
  
  // 3. 入力イベントをリッスン
  searchInput.addEventListener('input', function (event) {
    const query = event.target.value;
    resultsContainer.innerHTML = '';
    
    if (query.length &lt; 2) return; // 2文字以上で検索
    
    const results = idx.search(query);
    
    if (results.length &gt; 0) {
      results.forEach(function (result) {
        const item = documents.find(doc =&gt; doc.id == result.ref);
        const li = document.createElement('li');
        li.innerHTML = '&lt;a href="' + item.url + '"&gt;' + item.title + '&lt;/a&gt;';
        resultsContainer.appendChild(li);
      });
    } else {
      const noResult = document.createElement('li');
      noResult.textContent = '該当するページは見つかりませんでした。';
      resultsContainer.appendChild(noResult);
    }
  });
})();
&lt;/script&gt;</code></pre>
        <button class="copy-btn" title="Copy to clipboard">Copy</button>
      </div>
      <p>この方法はページ数が数十〜百ページ程度であれば十分に実用的です。</p>

      <h2 id="method-b">方法B：Algolia を使う（高機能な外部サービス） ☁️</h2>
      <p>高性能な外部サービスを利用するパターンです。サーバー側でインデックスを作成したり、フロントエンド向けAPIキーの管理、ランキングやファセット検索など高度な機能が使えます。規模が大きいサイトや検索体験を重視する場合に有利です。</p>

      <h3 id="algolia-merits">Algolia のメリット</h3>
      <ul>
        <li>高速でスケーラブルな検索</li>
        <li>ランキング/ファセット/レコメンドなどの高度機能</li>
        <li>ホスティングやセキュリティ面の利便性</li>
      </ul>

      <h3 id="algolia-cautions">Algolia の注意点</h3>
      <ul>
        <li>利用料金が発生する（無料枠はあるが制限あり）</li>
        <li>外部サービスに依存する設計になる</li>
      </ul>

      <h2 id="summary">まとめ ✅</h2>
      <p>小〜中規模の静的サイトでコストを抑え自前で完結させたいなら <strong>Lunr.js</strong> が現実的です。一方、検索体験・性能・運用性を重視する場合は <strong>Algolia</strong> を検討しましょう。</p>
    </article>
  </main>

  <footer class="site-footer">
    <div class="footer-container">
      <span>YaMac33</span> &copy; 
      <time datetime="2025-08-16">2025/08/16</time>
    </div>
  </footer>

  <script>
    document.querySelectorAll('.copy-btn').forEach(button => {
      button.addEventListener('click', () => {
        const pre = button.previousElementSibling;
        const code = pre.querySelector('code');
        const text = code.innerText;

        navigator.clipboard.writeText(text).then(() => {
          button.innerText = 'Copied!';
          setTimeout(() => {
            button.innerText = 'Copy';
          }, 2000);
        }).catch(err => {
          console.error('Failed to copy text: ', err);
        });
      });
    });
  </script>

</body>
</html>
